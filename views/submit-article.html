<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Article - Cultural Community</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        .alert-success {
            background: #D1FAE5;
            color: #065F46;
            border: 1px solid #10B981;
        }
        .alert-error {
            background: #FEE2E2;
            color: #991B1B;
            border: 1px solid #EF4444;
        }
    </style>
</head>
<body>
    <header class="header" id="header">
        <nav class="nav-container">
            <ul class="nav-menu" id="nav-menu">
                <li><a href="/" data-i18n="home">Home</a></li>
                <li><a href="/about" data-i18n="about">About</a></li>
                <li><a href="/culture" data-i18n="culture">Culture</a></li>
                <li><a href="/articles" data-i18n="articles">Articles</a></li>
                <li><a href="/members" data-i18n="members">Members</a></li>
                <li><a href="/events" data-i18n="events">Events</a></li>
                <li><a href="/contact" data-i18n="contact">Contact</a></li>
            </ul>
            <div class="auth-buttons">
                <div class="dropdown">
                    <button class="btn btn-icon dropdown-toggle" onclick="toggleDropdown()">‚ãÆ</button>
                    <div class="dropdown-menu" id="dropdown-menu">
                        <a href="/login" data-i18n="login">Login</a>
                        <a href="/register" data-i18n="join">Join</a>
                    </div>
                </div>
                <button id="lang-btn" class="btn btn-icon" onclick="toggleLang()" title="Change Language">üåç</button>
            </div>
        </nav>
    </header>

    <main class="container" style="margin-top: 6rem;">
        <section class="section">
            <h1 class="section-title" data-i18n="submitArticle">Submit Your Article</h1>
            <p style="text-align: center; color: var(--text-light); font-size: 1.1rem; margin-bottom: 3rem;" data-i18n="submitArticleDesc">
                Share your stories, experiences, and knowledge about our culture, traditions, and community with fellow members.
            </p>

            <div style="max-width: 900px; margin: 0 auto;">
                <div style="background: white; padding: 2.5rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                    <form id="article-form">
                        <div class="form-group">
                            <label for="article-title" data-i18n="articleTitle">Article Title *</label>
                            <input type="text" id="article-title" name="title" class="form-control" placeholder="Enter a compelling title for your article" required>
                        </div>

                        <div class="form-group">
                            <label for="article-category" data-i18n="category">Category *</label>
                            <select id="article-category" name="category" class="form-control" required>
                                <option value="">Select a category</option>
                                <option value="history" data-i18n="history">History</option>
                                <option value="culture" data-i18n="culture">Culture</option>
                                <option value="tradition" data-i18n="tradition">Tradition</option>
                                <option value="festival" data-i18n="festival">Festival</option>
                                <option value="food" data-i18n="food">Food</option>
                                <option value="language" data-i18n="language">Language</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="article-excerpt" data-i18n="shortSummary">Short Summary *</label>
                            <textarea id="article-excerpt" name="excerpt" class="form-control" rows="3" placeholder="Write a brief summary (2-3 sentences) that will appear in the article preview" required></textarea>
                            <small style="color: var(--text-light);">Maximum 200 characters</small>
                        </div>

                        <div class="form-group">
                            <label for="article-content" data-i18n="articleContent">Article Content *</label>
                            <textarea id="article-content" name="content" class="form-control" rows="15" placeholder="Write your article here. You can include paragraphs, stories, experiences, and insights about our culture and traditions." required></textarea>
                            <small style="color: var(--text-light);">Minimum 300 characters</small>
                        </div>

                        <div class="form-group">
                            <label for="article-image" data-i18n="featuredImage">Featured Image (Optional)</label>
                            <input type="file" id="article-image" name="image" class="form-control" accept="image/*">
                            <small style="color: var(--text-light);">Upload a main image for your article (JPG, PNG, max 5MB)</small>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="terms" required>
                                <span data-i18n="agreeTerms">I agree that my article may be reviewed and edited by administrators before publication *</span>
                            </label>
                        </div>

                        <div id="alert-message" style="display: none;"></div>

                        <button type="submit" class="btn btn-primary" data-i18n="submitArticleBtn" style="width: 100%; padding: 1rem; font-size: 1.1rem;">
                            Submit Article for Review
                        </button>
                    </form>
                </div>

                <div style="margin-top: 3rem; background: #EEF2FF; padding: 2rem; border-radius: 15px;">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;" data-i18n="submissionGuidelines">Submission Guidelines</h3>
                    <ul style="color: var(--text-dark); line-height: 1.8;">
                        <li data-i18n="guideline1">Articles should be original and written by you</li>
                        <li data-i18n="guideline2">Content should be relevant to our culture, traditions, or community</li>
                        <li data-i18n="guideline3">Use respectful language and maintain a positive tone</li>
                        <li data-i18n="guideline4">Include proper attribution for any quotes or references</li>
                        <li data-i18n="guideline5">Articles will be reviewed by administrators before publication</li>
                        <li data-i18n="guideline6">You will be notified via email once your article is published (if you provided email and opted in)</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3 data-i18n="about">About</h3>
                    <p data-i18n="footerAboutDesc">Preserving our cultural heritage and connecting community members worldwide.</p>
                    <p data-i18n="footerConnectDesc" style="margin-top: 1rem;">Join our community and stay updated with events and news.</p>
                    <a href="/register" class="btn btn-outline" data-i18n="join" style="margin-top: 1rem; display: inline-block; color: white; border-color: white;">Join</a>
                </div>
                <div class="footer-section">
                    <h3 data-i18n="footerQuickLinks">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="/about" data-i18n="about">About</a></li>
                        <li><a href="/culture" data-i18n="culture">Culture</a></li>
                        <li><a href="/articles" data-i18n="articles">Articles</a></li>
                        <li><a href="/members" data-i18n="members">Members</a></li>
                        <li><a href="/events" data-i18n="events">Events</a></li>
                        <li><a href="/contact" data-i18n="contact">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 <span data-i18n="footerRights">Tajpuriya Samaj. All rights reserved.</span></p>
                <p><span data-i18n="footerDeveloper">Developed by</span> <a href="https://devtaj.github.io/dev/" target="_blank">Dev Tajpuriya</a></p>
            </div>
        </div>
    </footer>

    <script src="/js/i18n-data.js"></script>
    <script src="/js/translations.js"></script>
    <script src="/js/effects.js"></script>
    <script src="/js/auth-nav.js"></script>
    <script>
// Check if user is logged in
const userData = JSON.parse(localStorage.getItem('user') || 'null');

function toggleDropdown() {
    document.getElementById('dropdown-menu').classList.toggle('show');
}

window.onclick = function(event) {
    if (!event.target.matches('.dropdown-toggle')) {
        const dropdowns = document.getElementsByClassName('dropdown-menu');
        for (let i = 0; i < dropdowns.length; i++) {
            dropdowns[i].classList.remove('show');
        }
    }
}

// Character counter for excerpt
document.getElementById('article-excerpt').addEventListener('input', function() {
    if (this.value.length > 200) {
        this.value = this.value.substring(0, 200);
    }
});

// Form submission
document.getElementById('article-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (!userData) {
        alert('Please login to submit articles');
        window.location.href = '/login';
        return;
    }
    
    const alertDiv = document.getElementById('alert-message');
    const submitBtn = this.querySelector('button[type="submit"]');
    
    const content = document.getElementById('article-content').value;
    if (content.length < 300) {
        alertDiv.className = 'alert alert-error';
        alertDiv.textContent = 'Article content must be at least 300 characters long.';
        alertDiv.style.display = 'block';
        return;
    }
    
    submitBtn.disabled = true;
    submitBtn.textContent = 'Submitting...';
    
    const formData = new FormData(this);
    
    try {
        const response = await fetch('/api/posts/submit', {
            method: 'POST',
            body: formData,
            credentials: 'include'
        });
        
        if (!response.ok) {
            if (response.status === 401) {
                alert('Session expired. Please login again.');
                window.location.href = '/login';
                return;
            }
            throw new Error('Submission failed');
        }
        
        const result = await response.json();
        
        alertDiv.className = 'alert alert-success';
        alertDiv.textContent = 'Thank you! Your article has been submitted successfully and is pending admin approval.';
        alertDiv.style.display = 'block';
        this.reset();
        window.scrollTo(0, 0);
    } catch (error) {
        alertDiv.className = 'alert alert-error';
        alertDiv.textContent = error.message || 'Unable to submit article. Please try again.';
        alertDiv.style.display = 'block';
    } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Article for Review';
    }
});
    </script>
</body>
</html>
