<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Tajpuriya Samaj</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .admin-header h1 {
            font-size: 2rem;
            color: var(--primary-color);
            margin: 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-box {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
        }
        
        .stat-box h3 {
            font-size: 2.5rem;
            margin: 0 0 0.5rem 0;
            font-weight: 700;
        }
        
        .stat-box p {
            margin: 0;
            opacity: 0.95;
            font-size: 1rem;
        }
        
        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .action-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s;
        }
        
        .action-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transform: translateY(-3px);
        }
        
        .action-card h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .action-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        .users-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .users-section h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .users-table {
            width: 100%;
            border-collapse: collapse;
            overflow: hidden;
        }
        
        .users-table thead {
            background: var(--primary-color);
            color: white;
        }
        
        .users-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }
        
        .users-table td {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .users-table tbody tr:hover {
            background: #f9f9f9;
        }
        
        .user-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
        }
        
        .status-badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-approved {
            background: #10B981;
            color: white;
        }
        
        .status-pending {
            background: #EF4444;
            color: white;
        }
        
        .action-btns {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .btn-approve {
            background: #10B981;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-approve:hover {
            background: #059669;
        }
        
        .btn-reject {
            background: #EF4444;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-reject:hover {
            background: #DC2626;
        }
        
        .btn-edit {
            background: #3B82F6;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-edit:hover {
            background: #2563EB;
        }
        
        .btn-delete {
            background: #6B7280;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-delete:hover {
            background: #4B5563;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            margin: 3% auto;
            padding: 2.5rem;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-header h2 {
            color: var(--primary-color);
            margin: 0;
        }
        
        .close {
            font-size: 2rem;
            color: #999;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close:hover {
            color: var(--primary-color);
        }
        
        .spinner {
            text-align: center;
            padding: 2rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <a href="/" class="logo"><img src="/images/tajpuriyasamajlogo.png" alt="Tajpuriya Samaj" class="logo-img"></a>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/culture">Culture</a></li>
                <li><a href="/members">Members</a></li>
                <li><a href="/events">Events</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
            <div class="auth-buttons">
                <span>Admin Panel</span>
                <button class="btn btn-secondary" onclick="app.logout()">Logout</button>
            </div>
        </nav>
    </header>

    <main class="admin-container">
        <div class="admin-header">
            <h1>Dashboard Overview</h1>
        </div>

        <div class="stats-grid">
            <div class="stat-box">
                <h3 id="total-members">0</h3>
                <p>Total Members</p>
            </div>
            <div class="stat-box">
                <h3 id="pending-members">0</h3>
                <p>Pending Approvals</p>
            </div>
            <div class="stat-box">
                <h3 id="total-events">0</h3>
                <p>Total Events</p>
            </div>
            <div class="stat-box">
                <h3 id="total-posts">0</h3>
                <p>Published Posts</p>
            </div>
        </div>

        <div class="action-cards">
            <div class="action-card">
                <h3>üìÖ Create Event</h3>
                <p>Add new community events and announcements</p>
                <button class="btn btn-primary" onclick="showCreateEventForm()">Create Event</button>
            </div>
            <div class="action-card">
                <h3>üìù Add Article</h3>
                <p>Publish cultural articles and blog posts</p>
                <button class="btn btn-primary" onclick="showCreatePostForm()">Add Article</button>
            </div>
            <div class="action-card">
                <h3>üí¨ View Messages</h3>
                <p>Review contact submissions and feedback</p>
                <button class="btn btn-primary" onclick="loadMessages()">View Messages</button>
            </div>
        </div>

        <div class="users-section">
            <h2>Registered Users</h2>
            <div id="all-users">
                <div class="spinner">Loading users...</div>
            </div>
        </div>

        <div class="users-section" style="margin-top: 2rem;">
            <h2>Pending Articles</h2>
            <div id="pending-posts">
                <div class="spinner">Loading articles...</div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="/about">About</a>
                <a href="/culture">Culture</a>
                <a href="/members">Members</a>
                <a href="/events">Events</a>
                <a href="/contact">Contact</a>
            </div>
            <p>&copy; 2024 Tajpuriya Samaj. All rights reserved.</p>
        </div>
    </footer>

    <!-- Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Event</h2>
                <span class="close" onclick="closeModal('event-modal')">&times;</span>
            </div>
            <form id="create-event-form" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="event-title">Event Title *</label>
                    <input type="text" id="event-title" name="title" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-description">Description *</label>
                    <textarea id="event-description" name="description" class="form-control" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="event-date">Date *</label>
                    <input type="date" id="event-date" name="date" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-time">Time *</label>
                    <input type="time" id="event-time" name="time" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-location">Location *</label>
                    <input type="text" id="event-location" name="location" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-type">Type</label>
                    <select id="event-type" name="type" class="form-control">
                        <option value="event">Event</option>
                        <option value="announcement">Announcement</option>
                        <option value="festival">Festival</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="event-image">Event Image</label>
                    <input type="file" id="event-image" name="image" class="form-control" accept="image/*">
                </div>
                <button type="submit" class="btn btn-primary">Create Event</button>
            </form>
        </div>
    </div>

    <!-- Post Modal -->
    <div id="post-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Article</h2>
                <span class="close" onclick="closeModal('post-modal')">&times;</span>
            </div>
            <form id="create-post-form" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="post-title">Article Title *</label>
                    <input type="text" id="post-title" name="title" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="post-excerpt">Excerpt *</label>
                    <textarea id="post-excerpt" name="excerpt" class="form-control" rows="2" required placeholder="Brief summary (max 200 characters)"></textarea>
                </div>
                <div class="form-group">
                    <label for="post-content">Content *</label>
                    <textarea id="post-content" name="content" class="form-control" rows="8" required></textarea>
                </div>
                <div class="form-group">
                    <label for="post-category">Category</label>
                    <select id="post-category" name="category" class="form-control" required>
                        <option value="history">History</option>
                        <option value="culture">Culture</option>
                        <option value="tradition">Tradition</option>
                        <option value="festival">Festival</option>
                        <option value="food">Food</option>
                        <option value="language">Language</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="post-image">Featured Image</label>
                    <input type="file" id="post-image" name="image" class="form-control" accept="image/*">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="isPublished" value="true" checked>
                        Publish immediately
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">Create Article</button>
            </form>
        </div>
    </div>

    <!-- Messages Modal -->
    <div id="messages-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Contact Messages</h2>
                <span class="close" onclick="closeModal('messages-modal')">&times;</span>
            </div>
            <div id="messages-container">
                <div class="spinner">Loading messages...</div>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="edit-user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit User</h2>
                <span class="close" onclick="closeModal('edit-user-modal')">&times;</span>
            </div>
            <form id="edit-user-form">
                <input type="hidden" id="edit-user-id">
                <div class="form-group">
                    <label for="edit-name">Name *</label>
                    <input type="text" id="edit-name" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-email">Email *</label>
                    <input type="email" id="edit-email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-phone">Phone *</label>
                    <input type="text" id="edit-phone" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-profession">Profession *</label>
                    <input type="text" id="edit-profession" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-address">Address</label>
                    <input type="text" id="edit-address" class="form-control">
                </div>
                <button type="submit" class="btn btn-primary">Update User</button>
            </form>
        </div>
    </div>

    <!-- View Article Modal -->
    <div id="view-article-modal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>Article Preview</h2>
                <span class="close" onclick="closeModal('view-article-modal')">&times;</span>
            </div>
            <div id="article-preview-content">
                <div class="spinner">Loading article...</div>
            </div>
        </div>
    </div>

    <script src="/js/main.js"></script>
    <script>
        function showCreateEventForm() {
            document.getElementById('event-modal').style.display = 'block';
        }

        function showCreatePostForm() {
            document.getElementById('post-modal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        async function loadAdminStats() {
            try {
                const [usersRes, eventsRes, postsRes, pendingPostsRes] = await Promise.all([
                    fetch('/api/auth/test-users'),
                    fetch('/api/events'),
                    fetch('/api/posts'),
                    fetch('/api/posts/admin/pending')
                ]);

                const usersData = await usersRes.json();
                const events = await eventsRes.json();
                const posts = await postsRes.json();
                const pendingPosts = await pendingPostsRes.json();
                
                const allUsers = usersData.users || [];
                const approvedMembers = allUsers.filter(u => u.isApproved === true);
                const pendingMembers = allUsers.filter(u => u.isApproved === false);

                document.getElementById('total-members').textContent = approvedMembers.length;
                document.getElementById('total-events').textContent = events.length;
                document.getElementById('total-posts').textContent = posts.length + ' / ' + pendingPosts.length + ' pending';
                document.getElementById('pending-members').textContent = pendingMembers.length;
            } catch (error) {
                console.error('Error loading admin stats:', error);
            }
        }

        async function loadMessages() {
            try {
                const response = await fetch('/api/posts/admin/contacts');
                const messages = await response.json();
                
                const container = document.getElementById('messages-container');
                container.innerHTML = messages.map(msg => `
                    <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 10px; margin-bottom: 1rem; border-left: 4px solid var(--primary-color);">
                        <h4 style="margin: 0 0 0.5rem 0; color: var(--primary-color);">${msg.subject}</h4>
                        <p style="margin: 0.3rem 0;"><strong>From:</strong> ${msg.name} (${msg.email})</p>
                        <p style="margin: 0.3rem 0;"><strong>Type:</strong> ${msg.type}</p>
                        <p style="margin: 0.3rem 0;"><strong>Date:</strong> ${new Date(msg.createdAt).toLocaleDateString()}</p>
                        <p style="margin: 1rem 0 0 0;">${msg.message}</p>
                    </div>
                `).join('');
                
                document.getElementById('messages-modal').style.display = 'block';
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        document.getElementById('create-event-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            try {
                const response = await fetch('/api/events', {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    alert('Event created successfully!');
                    closeModal('event-modal');
                    e.target.reset();
                    loadAdminStats();
                } else {
                    alert('Failed to create event');
                }
            } catch (error) {
                alert('Error creating event');
            }
        });

        document.getElementById('create-post-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            try {
                const response = await fetch('/api/posts', {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    alert('Article created successfully!');
                    closeModal('post-modal');
                    e.target.reset();
                    loadAdminStats();
                } else {
                    alert('Failed to create article');
                }
            } catch (error) {
                alert('Error creating article');
            }
        });

        async function loadAllUsers() {
            try {
                const response = await fetch('/api/auth/test-users');
                const data = await response.json();
                const allUsers = data.users || [];
                
                const container = document.getElementById('all-users');
                if (allUsers.length === 0) {
                    container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #999;">No users registered yet</p>';
                    return;
                }
                
                container.innerHTML = `
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>Photo</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Profession</th>
                                <th style="text-align: center;">Status</th>
                                <th style="text-align: center;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${allUsers.map(user => `
                                <tr>
                                    <td>
                                        <img src="${user.profileImage || '/images/default-avatar.png'}" 
                                             alt="${user.name}" 
                                             class="user-photo">
                                    </td>
                                    <td style="font-weight: 600;">${user.name}</td>
                                    <td>${user.email}</td>
                                    <td>${user.profession}</td>
                                    <td style="text-align: center;">
                                        <span class="status-badge ${user.isApproved ? 'status-approved' : 'status-pending'}">
                                            ${user.isApproved ? 'APPROVED' : 'PENDING'}
                                        </span>
                                    </td>
                                    <td style="text-align: center;">
                                        ${!user.isApproved ? `
                                            <div class="action-btns">
                                                <button class="btn-approve" onclick="approveUser('${user._id}')">Approve</button>
                                                <button class="btn-reject" onclick="rejectUser('${user._id}')">Reject</button>
                                            </div>
                                        ` : `
                                            <div class="action-btns">
                                                <button class="btn-edit" onclick="editUser('${user._id}')">Edit</button>
                                                <button class="btn-delete" onclick="deleteUser('${user._id}')">Delete</button>
                                            </div>
                                        `}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }

        async function approveUser(userId) {
            try {
                const response = await fetch(`/api/auth/approve/${userId}`, { method: 'PUT' });
                if (response.ok) {
                    alert('User approved successfully!');
                    loadAllUsers();
                    loadAdminStats();
                }
            } catch (error) {
                alert('Failed to approve user');
            }
        }

        async function rejectUser(userId) {
            if (!confirm('Are you sure you want to reject this user?')) return;
            try {
                const response = await fetch(`/api/auth/reject/${userId}`, { method: 'DELETE' });
                if (response.ok) {
                    alert('User rejected successfully!');
                    loadAllUsers();
                    loadAdminStats();
                }
            } catch (error) {
                alert('Failed to reject user');
            }
        }

        async function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) return;
            try {
                const response = await fetch(`/api/auth/user/${userId}`, { method: 'DELETE' });
                if (response.ok) {
                    alert('User deleted successfully!');
                    loadAllUsers();
                    loadAdminStats();
                }
            } catch (error) {
                alert('Failed to delete user');
            }
        }

        function editUser(userId) {
            fetch('/api/auth/test-users')
                .then(res => res.json())
                .then(data => {
                    const user = data.users.find(u => u._id === userId);
                    if (user) {
                        document.getElementById('edit-user-id').value = user._id;
                        document.getElementById('edit-name').value = user.name;
                        document.getElementById('edit-email').value = user.email;
                        document.getElementById('edit-phone').value = user.phone;
                        document.getElementById('edit-profession').value = user.profession;
                        document.getElementById('edit-address').value = user.address?.street || '';
                        document.getElementById('edit-user-modal').style.display = 'block';
                    }
                });
        }

        document.getElementById('edit-user-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const userId = document.getElementById('edit-user-id').value;
            const userData = {
                name: document.getElementById('edit-name').value,
                email: document.getElementById('edit-email').value,
                phone: document.getElementById('edit-phone').value,
                profession: document.getElementById('edit-profession').value,
                address: { street: document.getElementById('edit-address').value }
            };

            try {
                const response = await fetch(`/api/auth/user/${userId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });

                if (response.ok) {
                    alert('User updated successfully!');
                    closeModal('edit-user-modal');
                    loadAllUsers();
                } else {
                    alert('Failed to update user');
                }
            } catch (error) {
                alert('Error updating user');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            loadAdminStats();
            loadAllUsers();
            loadPendingPosts();
        });

        async function loadPendingPosts() {
            try {
                console.log('Loading pending posts...');
                const response = await fetch('/api/posts/admin/pending', {
                    credentials: 'include'
                });
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    console.error('Failed to load pending posts:', response.status);
                    const container = document.getElementById('pending-posts');
                    container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #EF4444;">Failed to load pending articles. Please refresh the page.</p>';
                    return;
                }
                
                const posts = await response.json();
                console.log('Pending posts:', posts);
                
                const container = document.getElementById('pending-posts');
                if (posts.length === 0) {
                    container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #999;">No pending articles</p>';
                    return;
                }
                
                container.innerHTML = `
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Category</th>
                                <th>Submitted</th>
                                <th style="text-align: center;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${posts.map(post => `
                                <tr>
                                    <td style="font-weight: 600;">${post.title}</td>
                                    <td>${post.author?.name || 'Unknown'}</td>
                                    <td>${post.category}</td>
                                    <td>${new Date(post.createdAt).toLocaleDateString()}</td>
                                    <td style="text-align: center;">
                                        <div class="action-btns">
                                            <button class="btn-edit" onclick="viewPost('${post._id}')">View</button>
                                            <button class="btn-approve" onclick="approvePost('${post._id}')">Approve</button>
                                            <button class="btn-reject" onclick="deletePost('${post._id}')">Reject</button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('Error loading pending posts:', error);
                const container = document.getElementById('pending-posts');
                container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #EF4444;">Error loading pending articles</p>';
            }
        }

        async function approvePost(postId) {
            try {
                const response = await fetch(`/api/posts/admin/approve/${postId}`, { method: 'PUT' });
                if (response.ok) {
                    alert('Article approved successfully!');
                    loadPendingPosts();
                    loadAdminStats();
                }
            } catch (error) {
                alert('Failed to approve article');
            }
        }

        async function deletePost(postId) {
            if (!confirm('Are you sure you want to reject this article?')) return;
            try {
                const response = await fetch(`/api/posts/admin/reject/${postId}`, { method: 'DELETE' });
                if (response.ok) {
                    alert('Article rejected successfully!');
                    loadPendingPosts();
                    loadAdminStats();
                }
            } catch (error) {
                alert('Failed to reject article');
            }
        }

        async function viewPost(postId) {
            try {
                const response = await fetch(`/api/posts/${postId}`);
                if (!response.ok) throw new Error('Failed to load article');
                
                const post = await response.json();
                
                document.getElementById('article-preview-content').innerHTML = `
                    <div style="padding: 1rem;">
                        <span style="display: inline-block; padding: 0.4rem 1rem; background: var(--primary-color); color: white; border-radius: 20px; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; margin-bottom: 1rem;">
                            ${post.category}
                        </span>
                        
                        <h2 style="color: var(--primary-color); margin-bottom: 1rem;">${post.title}</h2>
                        
                        <div style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                            <small style="color: var(--text-light);">By ${post.author?.name || 'Unknown'}</small>
                            <small style="color: var(--text-light); margin-left: 1rem;">‚Ä¢</small>
                            <small style="color: var(--text-light); margin-left: 1rem;">${new Date(post.createdAt).toLocaleDateString()}</small>
                        </div>
                        
                        ${post.image ? `<img src="${post.image}" alt="${post.title}" style="width: 100%; max-height: 400px; object-fit: cover; border-radius: 10px; margin-bottom: 1.5rem;">` : ''}
                        
                        <div style="background: #f9f9f9; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                            <strong>Excerpt:</strong>
                            <p style="margin: 0.5rem 0 0 0;">${post.excerpt}</p>
                        </div>
                        
                        <div style="line-height: 1.8; color: var(--text-dark); white-space: pre-wrap;">
                            ${post.content}
                        </div>
                    </div>
                `;
                
                document.getElementById('view-article-modal').style.display = 'block';
            } catch (error) {
                alert('Failed to load article preview');
            }
        }
    </script>
</body>
</html>
